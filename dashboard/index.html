<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MMM Dashboard</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <link rel="stylesheet" href="./styles.css"/>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.13.4/dist/ethers.umd.min.js"></script>
</head>

<body>
  <!-- Loading overlay -->
  <div id="loadingOverlay" class="overlay hidden">
    <div class="overlay-card">
      <div class="spinner"></div>
      <div id="loadingText" class="overlay-text">Loading...</div>
    </div>
  </div>

  <header class="topbar">
    <div class="topbar-left">
      <div class="brand">
        <div class="brand-dot"></div>
        <div class="brand-title">MMM Dashboard</div>
      </div>

      <div class="links">
        <a id="mmmLink" class="link" href="#" target="_blank" rel="noreferrer">MMM</a>
        <a id="trackerLink" class="link" href="#" target="_blank" rel="noreferrer">Tracker</a>
        <a id="poolLink" class="link" href="#" target="_blank" rel="noreferrer">Pool</a>
      </div>
    </div>

    <div class="topbar-right">
      <button id="refreshBtn" class="btn btn--ghost" type="button">
        <i class="fa-solid fa-rotate"></i> Refresh
      </button>

      <button id="connectBtn" class="btn btn--primary" type="button">
        <span id="connectLabel">Connect</span>
      </button>

      <button id="disconnectBtn" class="btn btn--ghost" type="button" disabled>
        Disconnect
      </button>
    </div>
  </header>

  <main class="container">
    <!-- KPIs -->
    <section class="grid grid--kpis">
      <div class="card kpi">
        <div class="kpi-title">Taxes Collected (MMM)</div>
        <div id="kpiTaxes" class="kpi-value">—</div>
        <div class="kpi-sub">MMM held by MMM token contract</div>
      </div>

      <div class="card kpi">
        <div class="kpi-title">Tracker Balance (MON)</div>
        <div id="kpiTrackerMon" class="kpi-value">—</div>
        <div class="kpi-sub">Native MON held by tracker</div>
      </div>

      <div class="card kpi">
        <div class="kpi-title">Price (MMM/MON)</div>
        <div id="kpiPrice" class="kpi-value kpi-value--small">—</div>
        <div id="kpiPriceCardText" class="kpi-sub">—</div>
      </div>

      <div class="card kpi">
        <div class="kpi-title">Last refresh</div>
        <div id="kpiRefresh" class="kpi-value">—</div>
        <div class="kpi-sub">Local time</div>
      </div>
    </section>

    <!-- Row 2: pool + image -->
    <section class="grid grid--row2">
      <div class="card">
        <h3>Pool Reserves</h3>
        <div class="row">
          <div class="label">MMM</div>
          <div id="poolMmmReserves" class="value">—</div>
        </div>
        <div class="row">
          <div class="label">WMON</div>
          <div id="poolWmonReserves" class="value">—</div>
        </div>
      </div>

      <div class="card">
        <h3>Notes</h3>
        <p class="muted">This page sends swaps with encoded calldata. If you ever see data:"" again, the JS file you think is loaded is not the one actually running.</p>
      </div>

      <div class="card image-card">
        <div id="watchedSlider" class="watched-slider">
          <div class="watched-slide is-active"><img src="./img/slide1.png" alt="slide1"></div>
          <div class="watched-slide"><img src="./img/slide2.png" alt="slide2"></div>
          <div class="watched-dots">
            <button class="watched-dot is-active" data-slide="0" type="button"></button>
            <button class="watched-dot" data-slide="1" type="button"></button>
          </div>
        </div>
      </div>
    </section>

    <!-- Row 3: Connected + image -->
    <section class="grid grid--row3">
      <div id="connectedCard" class="card"></div>
      <div class="card image-card">
        <div class="image-placeholder">Image</div>
      </div>
    </section>

    <!-- Row 4: Swap + Send -->
    <section class="grid grid--row4">
      <div class="card">
        <h3>Swap</h3>

        <div class="row">
          <div class="label">Side</div>
          <select id="swapSide" class="select">
            <option value="BUY">BUY (MON → MMM)</option>
            <option value="SELL">SELL (MMM → MON)</option>
          </select>
        </div>

        <div class="row">
          <div class="label">Amount In</div>
          <input id="swapAmountIn" class="input" placeholder="0.01" />
        </div>

        <div class="row">
          <div class="label">Slippage %</div>
          <select id="swapSlippage" class="select">
            <option value="1">1%</option>
            <option value="3">3%</option>
            <option value="5">5%</option>
            <option value="10">10%</option>
          </select>
        </div>

        <div class="row">
          <div class="label">Quote Out</div>
          <div id="swapQuoteOut" class="value">—</div>
        </div>

        <div class="row actions">
          <button id="swapApproveBtn" class="btn btn--ghost" type="button">Approve</button>
          <button id="swapExecBtn" class="btn btn--primary" type="button">Execute Swap</button>
        </div>
      </div>

      <div class="card">
        <h3>Send MMM</h3>

        <div class="row">
          <div class="label">From</div>
          <select id="walletSelect" class="select"></select>
        </div>

        <div class="row">
          <div class="label">Amount</div>
          <input id="amountInput" class="input" placeholder="1000" />
        </div>

        <div class="chips">
          <button class="chip" data-pct="0.25" type="button">25%</button>
          <button class="chip" data-pct="0.5" type="button">50%</button>
          <button class="chip" data-pct="0.75" type="button">75%</button>
          <button class="chip" data-pct="1" type="button">100%</button>
        </div>

        <div class="row">
          <div class="label">Recipient</div>
          <input id="recipientInput" class="input" placeholder="0x..." />
        </div>

        <div class="row actions">
          <button id="sendBtn" class="btn btn--primary" type="button">Send</button>
        </div>

        <div class="muted" id="availableBalance"></div>
      </div>
    </section>

    <!-- Watched + logs -->
    <section class="grid grid--row5">
      <div class="card">
        <h3>Watched Wallets</h3>
        <div class="row actions">
          <button id="addWatchBtn" class="btn btn--ghost" type="button">Add</button>
          <button id="watchConnectedBtn" class="btn btn--ghost" type="button">Watch Connected</button>
          <button id="resetBtn" class="btn btn--ghost" type="button">Reset</button>
        </div>
        <div id="walletsContainer" class="wallets"></div>
      </div>

      <div class="card">
        <h3>Activity</h3>
        <div class="row actions">
          <button id="clearLogBtn" class="btn btn--ghost" type="button">Clear</button>
        </div>
        <table class="table">
          <thead>
            <tr><th>Type</th><th>Tx</th><th>Status</th><th>Date</th></tr>
          </thead>
          <tbody id="txBody"></tbody>
        </table>
      </div>
    </section>
  </main>

  <!-- IMPORTANT: ethers v6 UMD -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.13.4/dist/ethers.umd.min.js"></script>
  <script src="./App.js"></script>
</body>
</html>
